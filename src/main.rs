mod graphics;

use graphics::matrix::Matrix;
use graphics::PPMImg;

// credit: https://github.com/WilliamC07/graphics-matrix/blob/master/edges.json
const POINTS: [i32; 1324] = [
    45, 71, 211, 72, 211, 71, 215, 99, 215, 99, 370, 98, 370, 98, 369, 109, 369, 109, 193, 111,
    193, 111, 194, 99, 192, 98, 211, 97, 191, 97, 65, 95, 44, 69, 45, 223, 45, 223, 209, 224, 209,
    224, 216, 234, 216, 234, 198, 236, 198, 236, 191, 227, 47, 223, 64, 230, 64, 230, 65, 336, 65,
    336, 192, 336, 192, 336, 191, 227, 97, 239, 162, 239, 162, 239, 162, 334, 97, 241, 96, 336,
    369, 108, 336, 159, 336, 159, 337, 208, 337, 208, 453, 209, 453, 209, 454, 344, 454, 344, 323,
    344, 323, 344, 303, 331, 303, 331, 198, 332, 198, 332, 194, 334, 225, 234, 303, 233, 303, 233,
    303, 330, 225, 235, 224, 330, 57, 88, 58, 205, 58, 205, 209, 207, 58, 88, 210, 88, 191, 96,
    194, 205, 198, 128, 196, 204, 192, 106, 198, 127, 198, 127, 331, 128, 331, 128, 331, 210, 331,
    210, 336, 210, 226, 219, 303, 219, 303, 219, 303, 133, 303, 133, 226, 133, 226, 133, 227, 217,
    333, 228, 333, 339, 308, 246, 332, 227, 332, 227, 454, 226, 309, 244, 308, 233, 308, 233, 332,
    209, 332, 209, 335, 209, 335, 209, 335, 209, 337, 209, 334, 209, 0, 266, 37, 270, 37, 270, 38,
    263, 38, 263, 65, 269, 0, 316, 39, 313, 39, 313, 39, 307, 39, 307, 64, 306, 1, 335, 63, 324, 0,
    357, 313, 359, 313, 359, 305, 350, 305, 350, 368, 351, 368, 351, 391, 361, 391, 361, 498, 359,
    454, 272, 476, 272, 476, 272, 476, 283, 476, 283, 498, 284, 309, 360, 309, 437, 309, 437, 2,
    435, 390, 360, 389, 439, 389, 439, 498, 438, 312, 361, 370, 361, 370, 362, 371, 370, 371, 370,
    374, 373, 374, 373, 374, 381, 374, 381, 376, 385, 376, 385, 377, 393, 377, 393, 379, 397, 379,
    397, 380, 405, 380, 405, 383, 408, 383, 408, 383, 418, 383, 418, 386, 421, 386, 421, 386, 431,
    386, 431, 388, 434, 388, 434, 388, 440, 388, 440, 317, 440, 317, 440, 317, 436, 317, 436, 318,
    432, 318, 432, 318, 422, 318, 422, 315, 419, 315, 419, 313, 408, 313, 408, 313, 406, 313, 406,
    313, 397, 313, 397, 313, 394, 313, 394, 313, 384, 313, 384, 313, 382, 313, 382, 313, 372, 313,
    372, 313, 371, 313, 371, 313, 362, 317, 439, 311, 439, 1, 346, 20, 342, 20, 342, 273, 342, 273,
    342, 279, 357, 330, 245, 330, 327, 304, 327, 330, 327, 309, 246, 329, 246, 334, 227, 336, 227,
    336, 227, 337, 344, 334, 344, 337, 344, 332, 340, 332, 344, 340, 227, 343, 227, 343, 227, 343,
    344, 343, 344, 340, 344, 340, 344, 340, 227, 346, 227, 350, 227, 350, 227, 349, 344, 349, 344,
    346, 344, 346, 344, 347, 227, 351, 227, 355, 227, 355, 227, 355, 344, 355, 344, 352, 344, 352,
    344, 352, 226, 425, 227, 426, 340, 426, 340, 423, 339, 423, 339, 423, 230, 423, 230, 421, 231,
    421, 231, 356, 231, 432, 226, 432, 344, 432, 344, 434, 344, 434, 344, 435, 226, 435, 226, 432,
    226, 304, 329, 324, 340, 324, 340, 453, 340, 454, 340, 500, 350, 500, 350, 500, 355, 500, 355,
    455, 345, 198, 234, 198, 332, 443, 227, 443, 340, 443, 340, 446, 340, 446, 340, 447, 227, 355,
    246, 386, 246, 386, 246, 387, 328, 384, 328, 331, 328, 210, 206, 210, 223, 211, 206, 216, 218,
    215, 218, 215, 234, 99, 241, 100, 257, 99, 258, 116, 258, 116, 258, 115, 241, 115, 241, 97,
    241, 121, 240, 139, 241, 139, 241, 139, 257, 139, 257, 121, 257, 121, 257, 121, 241, 144, 239,
    161, 239, 161, 239, 162, 257, 162, 257, 145, 257, 145, 257, 144, 240, 100, 261, 100, 330, 100,
    330, 114, 330, 114, 330, 115, 262, 115, 262, 100, 262, 121, 260, 139, 260, 139, 260, 139, 332,
    139, 332, 121, 332, 121, 258, 121, 330, 144, 262, 160, 263, 160, 263, 159, 331, 159, 331, 145,
    331, 145, 331, 145, 263, 58, 159, 209, 162, 209, 162, 215, 181, 215, 181, 214, 216, 209, 205,
    209, 162, 98, 114, 116, 114, 116, 114, 116, 130, 116, 130, 99, 130, 99, 130, 99, 114, 121, 114,
    121, 131, 121, 131, 138, 131, 138, 131, 138, 114, 138, 114, 121, 114, 143, 113, 143, 131, 143,
    131, 161, 131, 161, 131, 160, 114, 160, 114, 143, 114, 99, 136, 100, 164, 100, 164, 98, 164,
    98, 164, 98, 203, 98, 203, 112, 203, 112, 203, 112, 160, 112, 160, 115, 160, 115, 160, 115,
    136, 115, 136, 100, 136, 120, 134, 121, 161, 121, 161, 119, 161, 119, 161, 119, 205, 119, 205,
    137, 205, 137, 205, 137, 161, 137, 161, 139, 161, 139, 161, 139, 134, 139, 134, 120, 134, 143,
    134, 143, 160, 143, 160, 142, 161, 142, 161, 142, 204, 142, 204, 158, 204, 158, 204, 158, 161,
    158, 161, 161, 160, 161, 160, 161, 134, 161, 134, 143, 134, 227, 236, 228, 262, 228, 262, 243,
    262, 243, 262, 243, 236, 243, 236, 228, 237, 247, 237, 247, 262, 247, 262, 263, 262, 263, 262,
    263, 237, 263, 237, 246, 236, 266, 237, 283, 237, 283, 237, 283, 262, 283, 262, 266, 263, 266,
    263, 266, 237, 285, 237, 302, 237, 302, 237, 302, 264, 302, 264, 285, 263, 285, 263, 285, 237,
    285, 264, 302, 265, 302, 265, 302, 329, 302, 329, 286, 329, 286, 329, 285, 266, 283, 266, 283,
    266, 283, 266, 283, 329, 283, 329, 267, 328, 267, 328, 266, 265, 266, 265, 283, 265, 247, 265,
    264, 265, 264, 265, 264, 327, 246, 265, 247, 327, 247, 327, 264, 327, 228, 265, 243, 265, 243,
    265, 244, 327, 244, 327, 229, 327, 229, 327, 228, 265, 342, 237, 343, 230, 343, 230, 422, 232,
    422, 232, 408, 237, 342, 236, 408, 236, 386, 245, 394, 237, 408, 237, 408, 303, 408, 303, 420,
    303, 420, 303, 420, 334, 420, 334, 404, 334, 404, 334, 385, 329, 385, 329, 386, 246, 408, 237,
    408, 302, 408, 302, 420, 303, 420, 303, 420, 333, 420, 333, 403, 333, 394, 237, 394, 302, 394,
    302, 403, 303, 403, 303, 419, 303, 403, 303, 403, 333, 227, 135, 243, 135, 243, 135, 243, 151,
    243, 151, 228, 151, 228, 151, 228, 135, 247, 135, 263, 135, 263, 135, 263, 151, 263, 151, 247,
    151, 247, 151, 247, 136, 266, 136, 283, 136, 283, 136, 283, 152, 283, 152, 265, 151, 265, 151,
    265, 135, 284, 136, 301, 136, 301, 136, 301, 151, 301, 151, 285, 151, 285, 151, 284, 136, 227,
    153, 243, 152, 243, 152, 243, 217, 243, 217, 227, 217, 227, 217, 228, 153, 247, 152, 263, 153,
    263, 153, 264, 216, 264, 216, 247, 216, 247, 216, 247, 153, 267, 153, 283, 152, 283, 152, 283,
    216, 283, 216, 266, 216, 266, 216, 267, 153, 286, 153, 302, 153, 302, 153, 302, 216, 302, 216,
    286, 216, 286, 214, 285, 153, 19, 268, 19, 314, 39, 271, 39, 306, 55, 267, 55, 305, 476, 286,
    476, 344, 337, 158, 331, 158, 313, 361, 370, 361, 368, 352, 368, 360, 313, 370, 370, 370, 314,
    381, 374, 382, 314, 392, 377, 393, 314, 405, 380, 405, 315, 418, 382, 418, 316, 431, 385, 431,
    312, 439, 389, 439, 315, 421, 386, 421, 314, 381, 373, 382, 371, 370, 314, 370, 314, 393, 377,
    393, 316, 418, 382, 419, 317, 432, 386, 432, 313, 359, 313, 439, 308, 360, 309, 436, 64, 226,
    192, 226, 64, 226, 64, 230, 211, 88, 212, 96, 210, 69, 211, 89, 58, 88, 63, 95, 63, 95, 63,
    159, 63, 160, 62, 161, 62, 161, 62, 205, 93, 108, 93, 160, 93, 160, 93, 161, 93, 161, 93, 206,
    94, 107, 161, 108, 161, 108, 161, 161, 161, 161, 160, 161, 160, 161, 160, 205,
];

fn main() {
    let mut img = PPMImg::new(500, 500, 255);
    img.x_wrap = true;
    let mut m = Matrix::new(0, 4, Vec::with_capacity(1324 * 2));
    for point in POINTS.chunks(2) {
        m.append_edge(&mut vec![point[0] as f64, point[1] as f64, 0.0]);
    }

    // credit: https://www.tutorialspoint.com/computer_graphics/3d_computer_graphics.htm
    let mut t = Matrix::ident(4);
    t.set(3, 0, 50.0);

    for i in 0..10 {
        img.clear();
        m = m.mul(&t); // Can this step be sth that Mr. DW will talk about later?
        img.render_edge_matrix(&m);
        img.write_binary(format!("img{}.ppm", i).as_str())
            .expect("Error writing to file");
    }

    // NOTE: this is the code for image generation. For matrix tests, please see graphics/matrix.rs
}
